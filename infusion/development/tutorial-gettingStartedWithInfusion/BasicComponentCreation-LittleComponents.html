<!DOCTYPE html>
<html lang="en">
    <head>
        <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <title>Basic Component Creation - Little Components | Fluid Infusion</title>
        <link rel="stylesheet" href="../css/normalize.css">
        <link rel="stylesheet" href="../css/foundation.css">
        <link rel="stylesheet" href="../css/highlightjs-custom.css">
        <link rel="stylesheet" type="text/css" href="../lib/infusion/src/framework/preferences/css/Enactors.css" />
        <link rel="stylesheet" type="text/css" href="../lib/infusion/src/framework/preferences/css/PrefsEditor.css" />
        <link rel="stylesheet" type="text/css" href="../lib/infusion/src/framework/preferences/css/SeparatedPanelPrefsEditor.css" />
        <link rel="stylesheet" href="../css/infusion-docs.css">

        <link rel="icon" type="image/png" href="../images/favico.png">

        <script type="text/javascript" src="../lib/infusion/infusion-uio.js"></script>
    </head>
    <body class="infusion-docs">

        <div class="container infusion-docs-container">

            <!-- BEGIN markup for Preference Editor -->
            <div class="flc-prefsEditor-separatedPanel fl-prefsEditor-separatedPanel">
                <!-- This is the div that will contain the Preference Editor component -->
                <div class="flc-slidingPanel-panel flc-prefsEditor-iframe"></div>

                <!-- This div is for the sliding panel that shows and hides the Preference Editor controls -->
                <div class="fl-panelBar">
                    <span class="fl-prefsEditor-buttons">
                        <button id="reset" class="flc-prefsEditor-reset fl-prefsEditor-reset"><span class="fl-icon-undo"></span> Reset</button>
                        <button id="show-hide" class="flc-slidingPanel-toggleButton fl-prefsEditor-showHide"> Show/Hide</button>
                    </span>
                </div>
            </div>
            <!-- END markup for Preference Editor -->

            <script type="text/javascript">
                fluid.uiOptions.prefsEditor(".flc-prefsEditor-separatedPanel", {
                    "templatePrefix": "../lib/infusion/src/framework/preferences/html/",
                    "messagePrefix": "../lib/infusion/src/framework/preferences/messages/",
                    "tocTemplate": "../lib/infusion/src/components/tableOfContents/html/TableOfContents.html"
                });
            </script>

            <header class="row infusion-docs-header">
                <div class="infusion-docs-fluidLogo small-12 medium-3 column">
                    <a class="infusion-docs-fluidLogoText" href="../index.html" title="Infusion">infusion</a>
                </div>

                <nav class="small-12 medium-9 column">
                    <a href="../index.html" title="Infusion">Infusion</a>
                    <a href="../index-tutorials.html" title="Tutorials">Tutorials</a>
                    <a href="../index-api.html" title="A P I">API</a>
                </nav>
            </header>

            <div class="row infusion-docs-mainBody">
                <nav class="infusion-docs-TOC small-12 medium-3 column">
                    
                        
                        
                    
                        
                        
                            <span class="infusion-docs-category">Tutorials</span>
                            
                                <span class="infusion-docs-sectionName">Getting Started</span>
                                <ul>
                                    
                                        <li>
                                            
                                                <a href="GettingStartedWithInfusion.html"><span class="infusion-docs-TOC-pageName">Getting started with Infusion</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="SetUpYourEnvironment.html"><span class="infusion-docs-TOC-pageName">Set up your environment</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="DefineANamespaceAndCreateAClosure.html"><span class="infusion-docs-TOC-pageName">Define a namespace and create a closure</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="PickAComponentType.html"><span class="infusion-docs-TOC-pageName">Pick a component type</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <span class="infusion-docs-TOC-pageName">Basic Component Creation - Little Components</span>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="ModelComponents.html"><span class="infusion-docs-TOC-pageName">Model Components</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="EventedComponents.html"><span class="infusion-docs-TOC-pageName">Evented Components</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="ViewComponents.html"><span class="infusion-docs-TOC-pageName">View Components</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="RendererComponents.html"><span class="infusion-docs-TOC-pageName">Renderer Components</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="Subcomponents.html"><span class="infusion-docs-TOC-pageName">Subcomponents</span></a>
                                            
                                        </li>
                                    
                                </ul>
                            
                                <span class="infusion-docs-sectionName">Preferences Editor</span>
                                <ul>
                                    
                                        <li>
                                            
                                                <a href="../tutorial-creatingAPreferencesEditorUsingThePreferencesFramework/CreatingAPreferencesEditorUsingThePreferencesFramework.html"><span class="infusion-docs-TOC-pageName">Creating a preferences Editor Using the Preferences Framework</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="../tutorial-creatingAPreferencesEditorUsingThePreferencesFramework/CreatingAPrimarySchema.html"><span class="infusion-docs-TOC-pageName">Creating a Primary Schema</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="../tutorial-creatingAPreferencesEditorUsingThePreferencesFramework/CreatingPanels.html"><span class="infusion-docs-TOC-pageName">Creating Panels</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="../tutorial-creatingAPreferencesEditorUsingThePreferencesFramework/CreatingEnactors.html"><span class="infusion-docs-TOC-pageName">Creating Enactors</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="../tutorial-creatingAPreferencesEditorUsingThePreferencesFramework/CreatingAnAuxiliarySchema.html"><span class="infusion-docs-TOC-pageName">Creating an Auxiliary Schema</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="../tutorial-creatingAPreferencesEditorUsingThePreferencesFramework/InstantiatingThePreferencesEditor.html"><span class="infusion-docs-TOC-pageName">Instantiating the Preferences Editor</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="../tutorial-creatingAPreferencesEditorUsingThePreferencesFramework/InstantiatingTheEnhancerAndSettingsStoreOnly.html"><span class="infusion-docs-TOC-pageName">Instantiating the Enhancer and Settings Store Only</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="../tutorial-creatingAPreferencesEditorUsingThePreferencesFramework/StylingThePreferencesEditor.html"><span class="infusion-docs-TOC-pageName">Styling the Preferences Editor</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="../to-do/AddingPrefsEditorToSite.html"><span class="infusion-docs-TOC-pageName">Adding a Basic Preferences Editor to a Site</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="../to-do/WorkingWithPrefsEditorOnSite.html"><span class="infusion-docs-TOC-pageName">Working With A Preferences Editor On Your Site</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="../tutorial-usingStringTemplates/UsingStringTemplates.html"><span class="infusion-docs-TOC-pageName">Using String Templates</span></a>
                                            
                                        </li>
                                    
                                </ul>
                            
                                <span class="infusion-docs-sectionName">Creating an Adjuster UI</span>
                                <ul>
                                    
                                        <li>
                                            
                                                <a href="../tutorial-creatingANewAdjusterUI/CreatingANewAdjusterUI.html"><span class="infusion-docs-TOC-pageName">Creating a New Adjuster UI</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="../tutorial-creatingANewAdjusterUI/HowToCreateAndUseFontIcons.html"><span class="infusion-docs-TOC-pageName">How to Create and Use Font Icons</span></a>
                                            
                                        </li>
                                    
                                </ul>
                            
                                <span class="infusion-docs-sectionName">User Interface Options</span>
                                <ul>
                                    
                                        <li>
                                            
                                                <a href="../tutorial-userInterfaceOptions/UserInterfaceOptions.html"><span class="infusion-docs-TOC-pageName">User Interface Options</span></a>
                                            
                                        </li>
                                    
                                </ul>
                            
                        
                    
                        
                        
                    
                </nav>

                <article class="infusion-docs-mainContent small-12 medium-9 column">

                    <div class="flc-toc-tocContainer infusion-docs-toc"> </div>

                    <h1>Basic Component Creation - Little Components</h1>

                    <p class="infusion-docs-githubLink"><a href="https://github.com/fluid-project/infusion-docs/blob/master/src/documents/tutorial-gettingStartedWithInfusion/BasicComponentCreation-LittleComponents.md" target="_blank">Edit on GitHub</a></p>

                    

                    <div class="infusion-docs-articleBody">
                        <hr>
<p>Part of the <a href="GettingStartedWithInfusion.html">Getting Started with Infusion Tutorial</a></p>
<hr>
<p>Regardless of which grade of component you use, the basic structure will be the same. We&#39;ll use the simplest grade, a <strong>little component</strong>, to illustrate what this structure is. In future pages explaining other grades, you&#39;ll see the same principles.</p>
<p>The definition of a component involves two things:</p>
<ol>
<li>declare the component <strong>grade</strong> and any default values for the component&#39;s <strong>options</strong>. Options are used by integrators to customize the behaviour of a component.</li>
<li>define any public <strong>functions</strong> that the component requires to do its work.</li>
</ol>
<h2 id="grade-and-default-options">Grade and Default Options</h2>
<p>A component&#39;s grade and any default options are registered with the framework using a call to <a href="https://github.com/fluid-project/infusion/blob/infusion-1.5/src/framework/core/js/Fluid.js#L1519-L1539"><code>fluid.defaults</code></a>, which has two parameters: the component name and an object containing the defaults. The parent grades for the component are specified in an array in the defaults called <code>gradeNames</code>. For a <strong>little component</strong>, specify the grade as <code>fluid.littleComponent</code>:</p>
<pre class="highlight"><code class="hljs javascript">fluid.defaults(<span class="hljs-string">"tutorials.simpleComponent"</span>, {
    gradeNames: [<span class="hljs-string">"fluid.littleComponent"</span>, <span class="hljs-string">"autoInit"</span>],
    option1: <span class="hljs-string">"default value 1"</span>,
    ...
});
</code></pre>
<h3 id="options">Options</h3>
<p>Integrators can override your defaults when they instantiate the component, to customize its appearance or behaviour. The Framework will take care of <a href="../OptionsMerging.html">merging the integrator&#39;s values</a> with your defaults.</p>
<p>We&#39;ll go through some examples of options, to give you an idea of what they&#39;re all about.</p>
<h4 id="example-currency-converter-options">Example: Currency Converter Options</h4>
<p>Suppose you&#39;re creating a currency converter. You might wish to specify a default conversion rate:</p>
<pre class="highlight"><code class="hljs javascript">fluid.defaults(<span class="hljs-string">"tutorials.currencyConverter"</span>, {
    gradeNames: [<span class="hljs-string">"fluid.littleComponent"</span>, <span class="hljs-string">"autoInit"</span>],
    exchangeRate: <span class="hljs-number">1.035</span>
});
</code></pre>
<h4 id="example-inline-edit">Example: Inline Edit</h4>
<p>The Infusion <a href="../to-do/InlineEdit.html">Inline Edit</a> component uses a tooltip and defines (among other things) defaults for the delay before the tooltip appears, the text to display - even whether or not to enable it at all:</p>
<pre class="highlight"><code class="hljs javascript">fluid.defaults(<span class="hljs-string">"fluid.inlineEdit"</span>, {
    ...
    useTooltip: <span class="hljs-literal">true</span>,
    tooltipText: <span class="hljs-string">"Select or press Enter to edit"</span>,
    tooltipDelay: <span class="hljs-number">1000</span>, <span class="hljs-comment">// in milliseconds</span>
    ...
});
</code></pre>
<h4 id="example-progress">Example: Progress</h4>
<p>The Infusion <a href="../to-do/Progress.html">Progress</a> component uses jQuery animations to show and hide a progress bar. The defaults include objects that are passed to jQuery to configure the animations:</p>
<pre class="highlight"><code class="hljs javascript">fluid.defaults(<span class="hljs-string">"fluid.progress"</span>, {
    ...
    showAnimation: {
        params: {
            opacity: <span class="hljs-string">"show"</span>
        },
        duration: <span class="hljs-string">"slow"</span>
    }, <span class="hljs-comment">// forwarded to $().fadeIn("slow")</span>

    hideAnimation: {
        params: {
            opacity: <span class="hljs-string">"hide"</span>
        },
        duration: <span class="hljs-string">"slow"</span>
    }, <span class="hljs-comment">// forwarded to $().fadeOut("slow")</span>
    ...
});
</code></pre>
<h2 id="the-creator-function">The Creator Function</h2>
<p>All components have a <strong>creator function</strong>: a public function that is invoked to instantiate the component. In general, the framework will instantiate the creator function for you automatically, given the component&#39;s default options. When your component is registered as a <a href="../SubcomponentDeclaration.html">subcomponent</a> of another, the framework will also take responsibility for calling the creator function for you automatically. In the rare case you need to construct a component directly using a JavaScript function call, Infusion components have a standardized function signature:</p>
<ul>
<li><strong>little</strong>, <strong>evented</strong> and <strong>model</strong> components accept a single argument: options</li>
<li><strong>view</strong> and <strong>renderer</strong> components accept two arguments: container and options</li>
</ul>
<p><em>(We&#39;ll get into what these arguments are soon.)</em></p>
<p>Creator functions can be defined in one of two ways</p>
<ol>
<li>using <a href="../to-do/IoCInversionOfControl.html">IoC - Inversion of Control</a>: The framework will create the function according to your specifications</li>
<li>directly: You write the function yourself - <em>this option is not recommended, and the ability to do this will be removed in Infusion 2.0</em></li>
</ol>
<h3 id="using-ioc">Using IoC</h3>
<h4 id="automatic-creator-function-generation">Automatic creator function generation</h4>
<p>The <a href="../to-do/IoCInversionOfControl.html">IoC - Inversion of Control</a> system can automatically generate a component creator function for you. This is accomplished by added a special grade to the <code>gradeNames</code> property: <strong>&quot;autoInit&quot;</strong>:</p>
<pre class="highlight"><code class="hljs javascript">fluid.defaults(<span class="hljs-string">"tutorials.simpleComponent"</span>, {
    gradeNames: [<span class="hljs-string">"fluid.littleComponent"</span>, <span class="hljs-string">"autoInit"</span>],
    option1: <span class="hljs-string">"default value 1"</span>,
    ...
});
</code></pre>
<div class="infusion-docs-note"><strong>Note:</strong> in Infusion 2.0, <strong>&quot;autoInit&quot;</strong> will become the default for all components and will not need to be specified</div>

<h4 id="public-api-methods">Public API methods</h4>
<p>The standard means of adding public API functions to a component is to express them as Invokers. An invoker is a declarative record added into a components defaults, under the section <code>invokers</code>: the name of the record becomes the name of the public function which will be added. The invoker record defines the name of the public JavaScript function which should be executed when the method is called, as well as details of where the arguments that the function accepts should be sourced from - for example:</p>
<pre class="highlight"><code class="hljs javascript">fluid.defaults(<span class="hljs-string">"tutorials.simpleComponent"</span>, {
    gradeNames: [<span class="hljs-string">"fluid.littleComponent"</span>, <span class="hljs-string">"autoInit"</span>],
    option1: <span class="hljs-string">"default value 1"</span>,
    ...
    invokers: {
        publicFunction: {
            funcName: <span class="hljs-string">"tutorials.simpleComponent.publicFunction"</span>,
            args: <span class="hljs-string">"{that}"</span>
        }
    }
});

<span class="hljs-comment">// implementation of the public function registered as an invoker above</span>
tutorials.simpleComponent.publicFunction = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(that)</span> {</span>
    ...
};
</code></pre>
<p>You will note that the function <code>tutorials.simpleComponent.publicFunction</code> is a standard JavaScript function that could even be invoked directly from code if this were found relevant - it need not be necessarily bound as a component method (although most component methods tend not to make sense without being provided an instance of the relevant component).</p>
<h4 id="example-currency-converter-via-ioc">Example: Currency Converter via IoC</h4>
<p>So what would our currency converter example look like, create using IoC:</p>
<pre class="highlight"><code class="hljs javascript">fluid.defaults(<span class="hljs-string">"tutorials.currencyConverterAuto"</span>, {
    gradeNames: [<span class="hljs-string">"fluid.littleComponent"</span>, <span class="hljs-string">"autoInit"</span>],
    exchangeRate: <span class="hljs-number">1.035</span>,
    invokers: {
        convert: {
            funcName: <span class="hljs-string">"tutorials.currencyConverterAuto.convert"</span>,
            args: [<span class="hljs-string">"{that}.options.exchangeRate"</span>, <span class="hljs-string">"{arguments}.0"</span>] <span class="hljs-comment">// amount</span>
            }
        }
    }
});

<span class="hljs-comment">// The conversion function</span>
tutorials.currencyConverterAuto.convert = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(exchangeRate, amount)</span> {</span>
    <span class="hljs-keyword">return</span> amount * that.options.exchangeRate;
};
</code></pre>
<p>You&#39;ll notice that in this case we have been able to avoid binding to the entire component instance in our public function, and so our standalone public function <code>tutorials.currencyConverterAuto.convert</code> is indeed of more general utility than just for building a component method. This has happened because its responsibilities are particularly well-defined - you should always take the opportunity to restrict the binding behaviour of your public functions in this way whenever it is appropriate.</p>
<h3 id="writing-your-own-creator-function">Writing your own creator function</h3>
<div class="infusion-docs-note"><strong>Note:</strong> the scheme described here is not recommended for new code, and is described here only for completeness. The ability for users to write their component creator functions directly in JavaScript code will be <strong>removed</strong> in Infusion 2.0.</div>

<p>Creator functions follow a few basic steps:</p>
<ol>
<li>Create an object called <code>that</code> by calling the appropriate Framework component initialization function</li>
<li>Attach things to the object and otherwise initialize the component</li>
<li>Return the object</li>
</ol>
<p>Here&#39;s what that would look like for a <strong>little component</strong>:</p>
<pre class="highlight"><code class="hljs javascript"><span class="hljs-comment">// The global namespace</span>
<span class="hljs-keyword">var</span> tutorial = tutorial || {};

(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">($, fluid)</span> {</span>

    <span class="hljs-comment">// a creator function for a little component</span>
    <span class="hljs-comment">// creator functions are typically named by the component name itself</span>
    tutorials.sampleComponent = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options)</span> {</span>
        <span class="hljs-comment">// call the framework component initialization function</span>
        <span class="hljs-keyword">var</span> that = fluid.initLittleComponent(<span class="hljs-string">"tutorials.sampleComponent"</span>, options);

        <span class="hljs-comment">// attach any public methods to the 'that' object</span>
        that.publicFunction = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
            <span class="hljs-comment">// ...</span>
        };

        <span class="hljs-keyword">return</span> that;
    };

})(jQuery, fluid_2_0);
</code></pre>
<h4 id="example-currency-converter-creator-function">Example: Currency Converter Creator Function</h4>
<p>What would this look like for our currency converter example?</p>
<pre class="highlight"><code class="hljs javascript"><span class="hljs-comment">// creator function for the currency converter component</span>
tutorials.currencyConverter = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options)</span> {</span>
    <span class="hljs-keyword">var</span> that = fluid.initLittleComponent(<span class="hljs-string">"tutorials.currencyConverter"</span>, options);

    <span class="hljs-comment">// note that component methods have access to the values stored in 'options'</span>
    <span class="hljs-comment">// - the ones provided in the defaults and possibly overriden by implementors</span>
    that.convert = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(amount)</span> {</span>
        <span class="hljs-keyword">return</span> amount * that.options.exchangeRate;
    }
    <span class="hljs-keyword">return</span> that;
};
</code></pre>
<p>Next: <a href="ModelComponents.html">Model Components</a></p>

                    </div>

                </article>

            </div>

            <footer class="row infusion-docs-footer">
                <p class="infusion-docs-footerInfusion">Infusion is created by the <a href="http://fluidproject.org/" target="_blank">Fluid Project</a>,<br/>
                a project of the <a href="http://idrc.ocad.ca/" target="_blank">Inclusive Design Research Centre</a> at <a href="http://www.ocadu.ca/" target="_blank">OCAD University</a>, funded by a grant from <a href="http://www.mellon.org/" target="_blank">The Andrew W. Mellon Foundation</a>.</p>
            </footer>

        </div> <!-- end container -->

    </body>
</html>
