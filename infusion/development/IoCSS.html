<!DOCTYPE html>
<html lang="en">
    <head>
        <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
        <meta content="width=device-width, initial-scale=1.0" name="viewport">
        <title>IoCSS | Fluid Infusion</title>
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/foundation.css">
        <link rel="stylesheet" href="css/highlightjs-custom.css">
        <link rel="stylesheet" type="text/css" href="lib/infusion/src/framework/preferences/css/Enactors.css" />
        <link rel="stylesheet" type="text/css" href="lib/infusion/src/framework/preferences/css/PrefsEditor.css" />
        <link rel="stylesheet" type="text/css" href="lib/infusion/src/framework/preferences/css/SeparatedPanelPrefsEditor.css" />
        <link rel="stylesheet" href="css/infusion-docs.css">

        <link rel="icon" type="image/png" href="images/favico.png">

        <script type="text/javascript" src="lib/infusion/infusion-uio.js"></script>
    </head>
    <body class="infusion-docs">

        <div class="container infusion-docs-container">

            <!-- BEGIN markup for Preference Editor -->
            <div class="flc-prefsEditor-separatedPanel fl-prefsEditor-separatedPanel">
                <!-- This is the div that will contain the Preference Editor component -->
                <div class="flc-slidingPanel-panel flc-prefsEditor-iframe"></div>

                <!-- This div is for the sliding panel that shows and hides the Preference Editor controls -->
                <div class="fl-panelBar">
                    <span class="fl-prefsEditor-buttons">
                        <button id="reset" class="flc-prefsEditor-reset fl-prefsEditor-reset"><span class="fl-icon-undo"></span> Reset</button>
                        <button id="show-hide" class="flc-slidingPanel-toggleButton fl-prefsEditor-showHide"> Show/Hide</button>
                    </span>
                </div>
            </div>
            <!-- END markup for Preference Editor -->

            <script type="text/javascript">
                fluid.uiOptions.prefsEditor(".flc-prefsEditor-separatedPanel", {
                    "templatePrefix": "lib/infusion/src/framework/preferences/html/",
                    "messagePrefix": "lib/infusion/src/framework/preferences/messages/",
                    "tocTemplate": "lib/infusion/src/components/tableOfContents/html/TableOfContents.html"
                });
            </script>

            <header class="row infusion-docs-header">
                <div class="infusion-docs-fluidLogo small-12 medium-3 column">
                    <a class="infusion-docs-fluidLogoText" href="index.html" title="Infusion">infusion</a>
                </div>

                <nav class="small-12 medium-9 column">
                    <a href="index.html" title="Infusion">Infusion</a>
                    <a href="index-tutorials.html" title="Tutorials">Tutorials</a>
                    <a href="index-api.html" title="A P I">API</a>
                </nav>
            </header>

            <div class="row infusion-docs-mainBody">
                <nav class="infusion-docs-TOC small-12 medium-3 column">
                    
                        
                        
                            <span class="infusion-docs-category">Infusion</span>
                            
                                <span class="infusion-docs-sectionName">Components</span>
                                <ul>
                                    
                                        <li>
                                            
                                                <a href="FrameworkConcepts.html"><span class="infusion-docs-TOC-pageName">Framework Concepts</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="UnderstandingInfusionComponents.html"><span class="infusion-docs-TOC-pageName">Understanding Infusion Components</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="ComponentOptionsAndDefaults.html"><span class="infusion-docs-TOC-pageName">Understanding Component Options And Their Defaults</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="ComponentConfigurationOptions.html"><span class="infusion-docs-TOC-pageName">Component Configuration Options</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="ComponentGrades.html"><span class="infusion-docs-TOC-pageName">Component Grades</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="OptionsMerging.html"><span class="infusion-docs-TOC-pageName">Options Merging</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="ComponentLifecycle.html"><span class="infusion-docs-TOC-pageName">Component Lifecycle</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="DOMBinder.html"><span class="infusion-docs-TOC-pageName">DOM Binder</span></a>
                                            
                                        </li>
                                    
                                </ul>
                            
                                <span class="infusion-docs-sectionName">Inversion of Control</span>
                                <ul>
                                    
                                        <li>
                                            
                                                <a href="HowToUseInfusionIoC.html"><span class="infusion-docs-TOC-pageName">How To Use Infusion IoC</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="SubcomponentDeclaration.html"><span class="infusion-docs-TOC-pageName">Subcomponent Declaration</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="Contexts.html"><span class="infusion-docs-TOC-pageName">Contexts</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="Invokers.html"><span class="infusion-docs-TOC-pageName">Invokers</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="ExpansionOfComponentOptions.html"><span class="infusion-docs-TOC-pageName">Expansion Of Component Options</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <span class="infusion-docs-TOC-pageName">IoCSS</span>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="DeclarativeThisismInIoC.html"><span class="infusion-docs-TOC-pageName">Declarative this-ism In IoC</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="IoCReferences.html"><span class="infusion-docs-TOC-pageName">IoC References</span></a>
                                            
                                        </li>
                                    
                                </ul>
                            
                                <span class="infusion-docs-sectionName">Events</span>
                                <ul>
                                    
                                        <li>
                                            
                                                <a href="Events.html"><span class="infusion-docs-TOC-pageName">Events</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="InfusionEventSystem.html"><span class="infusion-docs-TOC-pageName">Infusion Event System</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="EventInjectionAndBoiling.html"><span class="infusion-docs-TOC-pageName">Event injection and boiling</span></a>
                                            
                                        </li>
                                    
                                </ul>
                            
                                <span class="infusion-docs-sectionName">ChangeApplier</span>
                                <ul>
                                    
                                        <li>
                                            
                                                <a href="ChangeApplier.html"><span class="infusion-docs-TOC-pageName">ChangeApplier</span></a>
                                            
                                        </li>
                                    
                                </ul>
                            
                                <span class="infusion-docs-sectionName">Renderer</span>
                                <ul>
                                    
                                        <li>
                                            
                                                <a href="Renderer.html"><span class="infusion-docs-TOC-pageName">Renderer</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="HowToUseTheRenderer.html"><span class="infusion-docs-TOC-pageName">How To Use the Renderer</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="RendererComponentTrees.html"><span class="infusion-docs-TOC-pageName">Renderer Component Trees</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="ProtoComponentTypes.html"><span class="infusion-docs-TOC-pageName">ProtoComponent Types</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="RendererComponentTreeExpanders.html"><span class="infusion-docs-TOC-pageName">Renderer Component Tree Expanders</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="Cutpoints.html"><span class="infusion-docs-TOC-pageName">Cutpoints</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="RendererComponents.html"><span class="infusion-docs-TOC-pageName">Renderer Components</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="RendererDecorators.html"><span class="infusion-docs-TOC-pageName">Renderer Decorators</span></a>
                                            
                                        </li>
                                    
                                </ul>
                            
                                <span class="infusion-docs-sectionName">Preferences Framework</span>
                                <ul>
                                    
                                        <li>
                                            
                                                <a href="PreferencesFramework.html"><span class="infusion-docs-TOC-pageName">Preferences Framework</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="PreferencesEditor.html"><span class="infusion-docs-TOC-pageName">Preferences Editor</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="Builder.html"><span class="infusion-docs-TOC-pageName">Builder</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="PrimarySchemaForPreferencesFramework.html"><span class="infusion-docs-TOC-pageName">Primary Schema</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="AuxiliarySchemaForPreferencesFramework.html"><span class="infusion-docs-TOC-pageName">Auxiliary Schema</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="ConnectingThePartsOfAPreferencesEditor.html"><span class="infusion-docs-TOC-pageName">Connecting the Parts of a Preferences Editor</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="Enactors.html"><span class="infusion-docs-TOC-pageName">Enactors</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="Panels.html"><span class="infusion-docs-TOC-pageName">Panels</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="CompositePanels.html"><span class="infusion-docs-TOC-pageName">Composite Panels</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="ConditionalSubpanels.html"><span class="infusion-docs-TOC-pageName">Conditional Subpanels</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="LocalizationInThePreferencesFramework.html"><span class="infusion-docs-TOC-pageName">Localization in the Preferences Framework</span></a>
                                            
                                        </li>
                                    
                                </ul>
                            
                                <span class="infusion-docs-sectionName">General</span>
                                <ul>
                                    
                                        <li>
                                            
                                                <a href="ModelRelay.html"><span class="infusion-docs-TOC-pageName">Model Relay</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="ProgressiveEnhancement.html"><span class="infusion-docs-TOC-pageName">Progressive Enhancement</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="ClassNameConventions.html"><span class="infusion-docs-TOC-pageName">Class Name Conventions</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="IoCTestingFramework.html"><span class="infusion-docs-TOC-pageName">IoC Testing Framework</span></a>
                                            
                                        </li>
                                    
                                </ul>
                            
                                <span class="infusion-docs-sectionName">Migrating to Infusion 1.5</span>
                                <ul>
                                    
                                        <li>
                                            
                                                <a href="APIChangesFrom1_4To1_5.html"><span class="infusion-docs-TOC-pageName">API Changes from 1.4 to 1.5</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="DeprecationsIn1_5.html"><span class="infusion-docs-TOC-pageName">Deprecations In 1.5</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="tutorial-migratingToInfusion1.5/UIOptionsMigration.html"><span class="infusion-docs-TOC-pageName">UI Options Migration</span></a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="tutorial-migratingToInfusion1.5/PagerMigration.html"><span class="infusion-docs-TOC-pageName">Pager Migration</span></a>
                                            
                                        </li>
                                    
                                </ul>
                            
                                <span class="infusion-docs-sectionName">Migrating to Infusion 2.0</span>
                                <ul>
                                    
                                        <li>
                                            
                                                <a href="APIChangesFrom1_5To2_0.html"><span class="infusion-docs-TOC-pageName">API Changes from 1.5 to 2.0</span></a>
                                            
                                        </li>
                                    
                                </ul>
                            
                        
                    
                        
                        
                    
                        
                        
                    
                </nav>

                <article class="infusion-docs-mainContent small-12 medium-9 column">

                    <div class="flc-toc-tocContainer infusion-docs-toc"> </div>

                    <h1>IoCSS</h1>

                    <p class="infusion-docs-githubLink"><a href="https://github.com/fluid-project/infusion-docs/blob/master/src/documents/IoCSS.md" target="_blank">Edit on GitHub</a></p>

                    

                    <div class="infusion-docs-articleBody">
                        <p>The Infusion Inversion of Control (IoC) system includes a simple method for distributing options from top-level components through the component tree. This method is dubbed &quot;IoCSS&quot; because it uses a CSS-like syntax.</p>
<h2 id="distributeoptions-and-iocss-downward-matching-css-like-context-selectors-for-options-forwarding">distributeOptions and IoCSS: Downward-Matching CSS-Like Context Selectors For Options Forwarding</h2>
<p>The <code>distributeOptions</code> option is a top-level block supported by every IoC-configured component. It specifies how options should be distributed to subcomponents further down the tree.</p>
<h2 id="background">Background</h2>
<p>As component trees become larger, it will often happen that a high-level component will need to specify options for a component further down the component tree. Without <code>distributeOptions</code>, component configuration can become very, what we might call, &quot;pointy&quot;:</p>
<pre class="highlight"><code class="hljs javascript"><span class="hljs-comment">// without developer's use of IoCSS, user writes</span>

fluid.uiOptions(<span class="hljs-string">".my-uio-container"</span>, {
    components: {
        templateLoader: {
            options: {
                templatePrefix: <span class="hljs-string">"../../myTemplates"</span>
                }
            }
        }
    }
);
</code></pre>
<p>The example above shows a simplified version of a situation with Infusion&#39;s &quot;UI Options&quot; component. In practice, the user of the component would have to write an even more deeply nested piece of configuration than this, if the developer had not made use of the <code>distributeOptions</code> directive in the component&#39;s options block, together with the use of &quot;IoCSS&quot; expressions to distribute the user&#39;s options to the right place in the component tree, as shown in the following example:</p>
<pre class="highlight"><code class="hljs javascript"><span class="hljs-comment">// developer writes:</span>

fluid.defaults(<span class="hljs-string">"fluid.uiOptions"</span>, {
    distributeOptions: {
        source: <span class="hljs-string">"{that}.options.templatePrefix"</span>,
        target: <span class="hljs-string">"{that &gt; templateLoader}.options.templatePrefix"</span>
    }
});

<span class="hljs-comment">// user writes:</span>

fluid.uiOptions(<span class="hljs-string">".my-uio-container"</span>, {
    templatePrefix: <span class="hljs-string">"../../myTemplates"</span>
});
</code></pre>
<p>In the <code>distributeOptions</code> block above, the context <code>{that &gt; templateLoader}</code> is an IoCSS expression which designates one or more of the child components of UI Options that are to receive the user&#39;s option. The syntax and meaning of these expressions is defined below.</p>
<p>As well as converting the exposed options structure of a component into a more compact form, <code>distributeOptions</code> is also a powerful tool for maintaining API stability for a component or family of components. Since the binding of IoCSS selectors such as <code>that &gt; templateLoader</code> onto child components is flexible, the component tree could be refactored in quite an aggressive way without requiring changes in either the user&#39;s configuration, or even the <code>distributeOptions</code> block itself. If the refactoring was even more thorough (involving wholesale removal of the target component, or a change in its important grades), the developer could still maintain stability of the external user API just by changing the <code>distributeOptions</code> block. In terms of a standard discussion on <a href="https://en.wikipedia.org/wiki/Software_design_pattern" title="Design Patterns">Design Patterns</a>, the use of <code>distributeOptions</code> could be seen as an automated and declarative scheme for achieving the ends of the <a href="https://en.wikipedia.org/wiki/Facade_pattern" title="Facade Design Pattern">Facade Design Pattern</a>, without the need for either user or developer code.</p>
<h2 id="-distributeoptions-format"><code>distributeOptions</code> format</h2>
<p>The <code>distributeOptions</code> option is a top-level block supported by every IoC-configured component, holding an array of objects (or single object) containing the following properties:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>target</td>
<td>(Required) An <a href="IoCReferences.html">IoC expression</a> describing the location in the component tree where the options are to be set. The &quot;context&quot; part of this expression will usually consist of an IoCSS selector (see below for format). However, it may also in specialised cases consist of a standard &quot;upwards&quot; IoC context expression, indicating that options are to be distributed to a parent component (this is only meaningful in the case the parent has not finished instantiating).</td>
</tr>
<tr>
<td>source</td>
<td>(Mutually exclusive with record) An <a href="IoCReferences.html">IoC expression</a> into the options structure of the source component, referencing what to copy to the target. If target&#39;s context is an IoCSS selector, the source must be the current component, i.e. <code>that</code>.</td>
</tr>
<tr>
<td>record</td>
<td>(Mutually exclusive with source) A record of options to set at the target.</td>
</tr>
<tr>
<td>removeSource</td>
<td>(Only possible if <code>source</code> is used) true/false: If true, the <code>source</code> options block is removed from its original site in the options structure when it is forwarded to the <code>target</code>.</td>
</tr>
<tr>
<td>exclusions</td>
<td>(Only possible if <code>source</code> is used) A list of EL paths into the <code>source</code> material which should not be forwarded. Whether or not <code>removeSource</code> is used, these will be retained in their original position in the source component&#39;s options.</td>
</tr>
</tbody>
</table>
<h2 id="iocss-selectors">IoCSS Selectors</h2>
<p>Component matching rules:</p>
<table>
<thead>
<tr>
<th>Form</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>*</td>
<td>matches any component - universal selector</td>
</tr>
<tr>
<td>E</td>
<td>matches any component holding a context name of E - special support for the string &quot;that&quot; as with standard IoC context matching</td>
</tr>
<tr>
<td>E#myid</td>
<td>matches any component with a context name of E with id equal to myid (of no use to developers since component ids cannot be predicted)</td>
</tr>
</tbody>
</table>
<p>Descendent rules</p>
<table>
<thead>
<tr>
<th>Form</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>E F</td>
<td>Matches any F component that is a descendant of an E component</td>
</tr>
<tr>
<td>E &gt; F</td>
<td>Matches any F component that is a direct child of an E component</td>
</tr>
</tbody>
</table>
<h2 id="example-source-">Example: <code>source</code></h2>
<pre class="highlight"><code class="hljs javascript">fluid.defaults(<span class="hljs-string">"fluid.tests.uploader"</span>, {
    gradeNames: [<span class="hljs-string">"fluid.littleComponent"</span>, <span class="hljs-string">"autoInit"</span>],
    components: {
        uploaderContext: {
            type: <span class="hljs-string">"fluid.progressiveCheckerForComponent"</span>,
            options: {componentName: <span class="hljs-string">"fluid.tests.uploader"</span>}
        },
        uploaderImpl: {
            type: <span class="hljs-string">"fluid.tests.uploaderImpl"</span>
        }
    },
    distributeOptions: [{
        target: <span class="hljs-string">"{that &gt; uploaderImpl}.options"</span> <span class="hljs-comment">// Target a directly nested component matching the context "uploaderImpl"</span>
        source: <span class="hljs-string">"{that}.options"</span>,               <span class="hljs-comment">// Distribute ALL of our options there, except exclusions:</span>
        exclusions: [<span class="hljs-string">"components.uploaderContext"</span>, <span class="hljs-string">"components.uploaderImpl"</span>], <span class="hljs-comment">// options targetted directly at these subcomponents are left undisturbed in place</span>

    }],
    progressiveCheckerOptions: {
        checks: [{
            feature: <span class="hljs-string">"{fluid.test}"</span>,
            contextName: <span class="hljs-string">"fluid.uploader.html5"</span>
        }]
    }
});
</code></pre>
<h2 id="example-record-">Example: <code>record</code></h2>
<pre class="highlight"><code class="hljs javascript">fluid.defaults(<span class="hljs-string">"fluid.moduleLayoutHandler"</span>, {
    gradeNames: [<span class="hljs-string">"fluid.layoutHandler"</span>, <span class="hljs-string">"autoInit"</span>],
    ...
    distributeOptions: {
        target: <span class="hljs-string">"{reorderer}.options"</span>, <span class="hljs-comment">// unusual: upward-matching selector distributes options back to parent before instantiation ends</span>
        record: {
            selectors: {
                movables: {
                    expander: {
                        func: <span class="hljs-string">"{that}.makeComputeModules"</span>,
                        args: [<span class="hljs-literal">false</span>],
                    }
                },
                dropTargets: {
                    expander: {
                        func: <span class="hljs-string">"{that}.makeComputeModules"</span>,
                        args: [<span class="hljs-literal">false</span>],
                    }
                },
                selectables: {
                    expander: {
                        func: <span class="hljs-string">"{that}.makeComputeModules"</span>,
                        args: [<span class="hljs-literal">true</span>],
                    }
                }
            }
        }
    }
});
</code></pre>

                    </div>

                </article>

            </div>

            <footer class="row infusion-docs-footer">
                <p class="infusion-docs-footerInfusion">Infusion is created by the <a href="http://fluidproject.org/" target="_blank">Fluid Project</a>,<br/>
                a project of the <a href="http://idrc.ocad.ca/" target="_blank">Inclusive Design Research Centre</a> at <a href="http://www.ocadu.ca/" target="_blank">OCAD University</a>, funded by a grant from <a href="http://www.mellon.org/" target="_blank">The Andrew W. Mellon Foundation</a>.</p>
            </footer>

        </div> <!-- end container -->

    </body>
</html>
